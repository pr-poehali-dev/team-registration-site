# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PHP Backend –Ω–∞ Timeweb

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å PHP API –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ Timeweb –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥.

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤

–í—Å–µ PHP —Ñ–∞–π–ª—ã —É–∂–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `public/php-backend/`:
- `api/teams.php` - –æ—Å–Ω–æ–≤–Ω–æ–π API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–º–∞–Ω–¥–∞–º–∏
- `api/registration-status.php` - API —Å—Ç–∞—Ç—É—Å–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `api/send-auth-code.php` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `api/notify-captain.php` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–Ω–∞–º
- `db/` - SQL —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Timeweb

**–ß–µ—Ä–µ–∑ FTP/SFTP:**
1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Ö–æ—Å—Ç–∏–Ω–≥—É —á–µ—Ä–µ–∑ FileZilla –∏–ª–∏ –¥—Ä—É–≥–æ–π FTP-–∫–ª–∏–µ–Ω—Ç
2. –ù–∞–π–¥–∏—Ç–µ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–∞–π—Ç–∞ (–æ–±—ã—á–Ω–æ `public_html/` –∏–ª–∏ `www/`)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫—É `php-backend/` –≤ –∫–æ—Ä–µ–Ω—å:
   ```
   public_html/
   ‚îú‚îÄ‚îÄ php-backend/
   ‚îÇ   ‚îú‚îÄ‚îÄ api/
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ teams.php
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ registration-status.php
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ send-auth-code.php
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ notify-captain.php
   ‚îÇ   ‚îî‚îÄ‚îÄ db/
   ‚îÇ       ‚îî‚îÄ‚îÄ init-registration-settings.sql
   ‚îî‚îÄ‚îÄ index.html
   ```

**–ß–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å Timeweb:**
1. –í–æ–π–¥–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ö–æ—Å—Ç–∏–Ω–≥–æ–º
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–∞–ø–∫—É `php-backend/` –≤ –∫–æ—Ä–µ–Ω—å —Å–∞–π—Ç–∞

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**
1. –í –ø–∞–Ω–µ–ª–∏ Timeweb –æ—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö MySQL (–µ—Å–ª–∏ –µ—â—ë –Ω–µ—Ç)
3. –ó–∞–ø–∏—à–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:
   - **–•–æ—Å—Ç**: `localhost` –∏–ª–∏ IP —Å–µ—Ä–≤–µ—Ä–∞
   - **–ò–º—è –ë–î**: `ce876244_tournam` (–≤–∞—à–µ –∏–º—è)
   - **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: –ª–æ–≥–∏–Ω –æ—Ç –ë–î
   - **–ü–∞—Ä–æ–ª—å**: –ø–∞—Ä–æ–ª—å –æ—Ç –ë–î

**–®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ PHP**
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `php-backend/api/teams.php` (—Å—Ç—Ä–æ–∫–∏ 8-11):

```php
$host = 'localhost';           // –∏–ª–∏ IP —Å–µ—Ä–≤–µ—Ä–∞
$dbname = 'ce876244_tournam';  // –∏–º—è –≤–∞—à–µ–π –ë–î
$username = 'your_db_user';    // –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î
$password = 'your_db_password'; // –ø–∞—Ä–æ–ª—å –ë–î
```

**–®–∞–≥ 3: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã**
1. –û—Ç–∫—Ä–æ–π—Ç–µ phpMyAdmin –≤ –ø–∞–Ω–µ–ª–∏ Timeweb
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "SQL"
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `php-backend/db/init-registration-settings.sql`

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PHP —Ñ–∞–π–ª—ã –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞:
```bash
chmod 644 php-backend/api/*.php
```

### 5. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ PHP API

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `src/config/api.ts`:

```typescript
const USE_TIMEWEB_API = true;  // –í–∫–ª—é—á–∏—Ç–µ Timeweb API
```

–û–±–Ω–æ–≤–∏—Ç–µ –ø—É—Ç–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ:
```typescript
export const API_CONFIG = {
  TEAMS_URL: '/php-backend/api/teams.php',
  SETTINGS_URL: '/php-backend/api/teams.php',
  AUTH_URL: '/php-backend/api/teams.php'
};
```

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

**–¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API**
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/php-backend/api/teams.php?resource=settings
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è JSON:
```json
{
  "is_open": true
}
```

**–¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–∞–π—Ç–∞
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –ø–æ—è–≤–∏–ª–∏—Å—å –≤ –ë–î

**–¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∫–∏**
1. –í–æ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ê–¥–º–∏–Ω"
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

## üîß –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞ "Not Found"
**–ü—Ä–∏—á–∏–Ω–∞**: PHP —Ñ–∞–π–ª—ã –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–∞–ø–∫–∞ `php-backend/` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ —Å–∞–π—Ç–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å –≤ `api.ts` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—é —Ñ–∞–π–ª–æ–≤

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ `teams.php`

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –ø–∞–Ω–µ–ª–∏ Timeweb
2. –û–±–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ñ–∞–π–ª–µ `teams.php`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å

### CORS –æ—à–∏–±–∫–∏
**–ü—Ä–∏—á–∏–Ω–∞**: –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å –¥—Ä—É–≥–æ–≥–æ –¥–æ–º–µ–Ω–∞

**–†–µ—à–µ–Ω–∏–µ**:
–î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ `teams.php` (—É–∂–µ –µ—Å—Ç—å –≤ –∫–æ–¥–µ):
```php
header('Access-Control-Allow-Origin: *');
header('Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS');
header('Access-Control-Allow-Headers: Content-Type');
```

### –ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ—Ç API
**–ü—Ä–∏—á–∏–Ω–∞**: PHP –Ω–µ –≤–∫–ª—é—á—ë–Ω –∏–ª–∏ –≤–µ—Ä—Å–∏—è PHP —É—Å—Ç–∞—Ä–µ–ª–∞

**–†–µ—à–µ–Ω–∏–µ**:
1. –í –ø–∞–Ω–µ–ª–∏ Timeweb –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é PHP (–Ω—É–∂–Ω–∞ 7.4+)
2. –í–∫–ª—é—á–∏—Ç–µ PHP –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ö–æ—Å—Ç–∏–Ω–≥–∞

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —É –≤–∞—Å –±—É–¥—É—Ç —Ç–∞–±–ª–∏—Ü—ã:

### `registration_settings`
```sql
- id (INT) - ID –∑–∞–ø–∏—Å–∏
- is_open (BOOLEAN) - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞?
- updated_at (TIMESTAMP) - –ö–æ–≥–¥–∞ –∏–∑–º–µ–Ω–µ–Ω–æ
- updated_by (VARCHAR) - –ö–µ–º –∏–∑–º–µ–Ω–µ–Ω–æ
```

### `teams`
```sql
- id (INT) - ID –∫–æ–º–∞–Ω–¥—ã
- team_name (VARCHAR) - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
- captain_name (VARCHAR) - –ò–º—è –∫–∞–ø–∏—Ç–∞–Ω–∞
- captain_telegram (VARCHAR) - Telegram –∫–∞–ø–∏—Ç–∞–Ω–∞
- members_count (INT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- members_info (TEXT) - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö
- status (ENUM) - –°—Ç–∞—Ç—É—Å: pending/approved/rejected
- auth_code (VARCHAR) - –ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- created_at (TIMESTAMP) - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
```

### `admin_users`
```sql
- id (INT) - ID –∞–¥–º–∏–Ω–∞
- username (VARCHAR) - –õ–æ–≥–∏–Ω
- password_hash (VARCHAR) - –•—ç—à –ø–∞—Ä–æ–ª—è
- is_super_admin (BOOLEAN) - –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω?
- created_at (TIMESTAMP) - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
```

## üöÄ –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `USE_TIMEWEB_API = true` –≤ `src/config/api.ts`
2. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥: `npm run build`
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PHP –≤ –ø–∞–Ω–µ–ª–∏ Timeweb
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ —Å–µ—Ç–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

**–°–æ–∑–¥–∞–Ω–æ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥**
–î–∞—Ç–∞: 2025-10-20
